{"ast":null,"code":"import axios from\"axios\";let refresh=false;axios.interceptors.response.use(resp=>resp,async error=>{if(error.response.status===401&&!refresh){refresh=true;console.log(localStorage.getItem('refresh_token'));const response=await axios.post('http://127.0.0.1:8000/token/refresh/',{refresh:localStorage.getItem('refresh_token')},{headers:{'Content-Type':'application/json'}},{withCredentials:true});if(response.status===200){axios.defaults.headers.common['Authorization']=\"Bearer \".concat(response.data['access']);localStorage.setItem('access_token',response.data.access);localStorage.setItem('refresh_token',response.data.refresh);return axios(error.config);}}refresh=false;return error;});","map":{"version":3,"names":["axios","refresh","interceptors","response","use","resp","error","status","console","log","localStorage","getItem","post","headers","withCredentials","defaults","common","concat","data","setItem","access","config"],"sources":["C:/Users/vovik/Desktop/restaurant-reviews-app/reviews/frontend/src/interceptors/axios.js"],"sourcesContent":["import axios from \"axios\";\r\nlet refresh = false;\r\naxios.interceptors.response.use(resp => resp, async error => {\r\n  if (error.response.status === 401 && !refresh) {\r\n     refresh = true;\r\n     console.log(localStorage.getItem('refresh_token'))\r\n     const response = await   \r\n           axios.post('http://127.0.0.1:8000/token/refresh/', {refresh:localStorage.getItem('refresh_token')}, {headers: {'Content-Type': 'application/json'}},{withCredentials: true});\r\n    if (response.status === 200) {\r\n       axios.defaults.headers.common['Authorization'] = `Bearer ${response.data['access']}`;\r\n       localStorage.setItem('access_token', response.data.access);\r\n       localStorage.setItem('refresh_token', response.data.refresh);\r\n       return axios(error.config);\r\n    }\r\n  }\r\nrefresh = false;\r\nreturn error;\r\n});"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,GAAI,CAAAC,OAAO,CAAG,KAAK,CACnBD,KAAK,CAACE,YAAY,CAACC,QAAQ,CAACC,GAAG,CAACC,IAAI,EAAIA,IAAI,CAAE,KAAM,CAAAC,KAAK,EAAI,CAC3D,GAAIA,KAAK,CAACH,QAAQ,CAACI,MAAM,GAAK,GAAG,EAAI,CAACN,OAAO,CAAE,CAC5CA,OAAO,CAAG,IAAI,CACdO,OAAO,CAACC,GAAG,CAACC,YAAY,CAACC,OAAO,CAAC,eAAe,CAAC,CAAC,CAClD,KAAM,CAAAR,QAAQ,CAAG,KACX,CAAAH,KAAK,CAACY,IAAI,CAAC,sCAAsC,CAAE,CAACX,OAAO,CAACS,YAAY,CAACC,OAAO,CAAC,eAAe,CAAC,CAAC,CAAE,CAACE,OAAO,CAAE,CAAC,cAAc,CAAE,kBAAkB,CAAC,CAAC,CAAC,CAACC,eAAe,CAAE,IAAI,CAAC,CAAC,CACnL,GAAIX,QAAQ,CAACI,MAAM,GAAK,GAAG,CAAE,CAC1BP,KAAK,CAACe,QAAQ,CAACF,OAAO,CAACG,MAAM,CAAC,eAAe,CAAC,WAAAC,MAAA,CAAad,QAAQ,CAACe,IAAI,CAAC,QAAQ,CAAC,CAAE,CACpFR,YAAY,CAACS,OAAO,CAAC,cAAc,CAAEhB,QAAQ,CAACe,IAAI,CAACE,MAAM,CAAC,CAC1DV,YAAY,CAACS,OAAO,CAAC,eAAe,CAAEhB,QAAQ,CAACe,IAAI,CAACjB,OAAO,CAAC,CAC5D,MAAO,CAAAD,KAAK,CAACM,KAAK,CAACe,MAAM,CAAC,CAC7B,CACF,CACFpB,OAAO,CAAG,KAAK,CACf,MAAO,CAAAK,KAAK,CACZ,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}