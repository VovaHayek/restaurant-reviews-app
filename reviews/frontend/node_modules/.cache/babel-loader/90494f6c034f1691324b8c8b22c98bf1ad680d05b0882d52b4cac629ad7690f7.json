{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useParams}from'react-router-dom';import axios from'axios';import VisitItem from'../components/VisitItem';import{ReactComponent as Plus}from'../assets/plus.svg';import{ReactComponent as Star}from'../assets/star.svg';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const RestaurantDetailPage=()=>{var _restaurant$amount_sp,_restaurant$average_r;let urlParams=useParams();let[restaurant,setRestaurant]=useState([]);let[visits,setVisits]=useState([]);let[accountInfo,setAccountInfo]=useState([]);//Visit form data\nlet[visitDate,setVisitDate]=useState(null);let[visitNote,setVisitNote]=useState('');let[visitExpence,setVisitExpence]=useState(0);let[visitEvaluation,setVisitEvaluation]=useState(1);useEffect(()=>{axios.get(\"http://127.0.0.1:8000/api/restaurants/\".concat(urlParams['restaurantName'],\"/\")).then(response=>{setRestaurant(response.data);});axios.get(\"http://127.0.0.1:8000/api/visits/\".concat(urlParams['restaurantName'],\"/\")).then(response=>{setVisits(response.data);});axios.get('http://127.0.0.1:8000/auth/account').then(response=>{setAccountInfo(response.data);});},[]);const submitVisitForm=async e=>{e.preventDefault();const visitFormData={date:visitDate,note:visitNote,expence:parseInt(visitExpence),evaluation:parseInt(visitEvaluation),restaurant:restaurant.id};await axios.post(\"http://127.0.0.1:8000/api/visits/\".concat(urlParams['restaurantName'],\"/\"),visitFormData,{headers:{'Content-Type':'application/json'},withCredentials:false}).then(response=>{axios.get(\"http://127.0.0.1:8000/api/visits/\".concat(urlParams['restaurantName'],\"/\")).then(response=>{setVisits(response.data);});});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"px-3\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"fw-bold\",children:restaurant===null||restaurant===void 0?void 0:restaurant.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"me-3\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"m-0 p-0\",children:\"Total amount spent\"}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"$ \",restaurant===null||restaurant===void 0?void 0:(_restaurant$amount_sp=restaurant.amount_spent)===null||_restaurant$amount_sp===void 0?void 0:_restaurant$amount_sp.expence__sum]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mx-3\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"m-0 p-0\",children:\"Rating\"}),/*#__PURE__*/_jsxs(\"h3\",{children:[/*#__PURE__*/_jsx(Star,{}),\" \",restaurant===null||restaurant===void 0?void 0:(_restaurant$average_r=restaurant.average_rating)===null||_restaurant$average_r===void 0?void 0:_restaurant$average_r.evaluation__avg]})]})]})]}),(accountInfo===null||accountInfo===void 0?void 0:accountInfo.id)===(restaurant===null||restaurant===void 0?void 0:restaurant.creator)?/*#__PURE__*/_jsx(\"div\",{className:\"w-100 d-flex flex-row justify-content-between align-items-end mt-5 px-3\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"d-flex flex-column\",onSubmit:submitVisitForm,children:[/*#__PURE__*/_jsx(\"h3\",{className:\"fw-bold\",children:\"Create Visit Form\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"my-2 mx-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"m-0 p-0\",children:\"Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",className:\"form-control\",onChange:e=>setVisitDate(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"my-2 mx-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"m-0 p-0\",children:\"Money spent\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"form-control\",onChange:e=>setVisitExpence(e.target.value)})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-row \",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"me-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"m-0 p-0\",children:\"Rating\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"form-control\",onChange:e=>setVisitEvaluation(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:1,children:\"1\"}),/*#__PURE__*/_jsx(\"option\",{value:2,children:\"2\"}),/*#__PURE__*/_jsx(\"option\",{value:3,children:\"3\"}),/*#__PURE__*/_jsx(\"option\",{value:4,children:\"4\"}),/*#__PURE__*/_jsx(\"option\",{value:5,children:\"5\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-100\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"m-0 p-0\",children:\"Note\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"w-100 form-control\",onChange:e=>setVisitNote(e.target.value)})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-success my-2\",children:\"Create Visit\"})]})}):null,/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"w-100 d-flex flex-column\",children:visits.map((visit,key)=>/*#__PURE__*/_jsx(VisitItem,{visit:visit},key))})]});};export default RestaurantDetailPage;","map":{"version":3,"names":["React","useEffect","useState","useParams","axios","VisitItem","ReactComponent","Plus","Star","jsx","_jsx","jsxs","_jsxs","RestaurantDetailPage","_restaurant$amount_sp","_restaurant$average_r","urlParams","restaurant","setRestaurant","visits","setVisits","accountInfo","setAccountInfo","visitDate","setVisitDate","visitNote","setVisitNote","visitExpence","setVisitExpence","visitEvaluation","setVisitEvaluation","get","concat","then","response","data","submitVisitForm","e","preventDefault","visitFormData","date","note","expence","parseInt","evaluation","id","post","headers","withCredentials","children","className","title","amount_spent","expence__sum","average_rating","evaluation__avg","creator","onSubmit","type","onChange","target","value","map","visit","key"],"sources":["C:/Users/vovik/Desktop/restaurant-reviews-app/reviews/frontend/src/pages/RestaurantDetailPage.js"],"sourcesContent":["import React, {useEffect, useState} from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport axios from 'axios';\r\n\r\nimport VisitItem from '../components/VisitItem';\r\n\r\nimport { ReactComponent as Plus } from '../assets/plus.svg';\r\nimport { ReactComponent as Star } from '../assets/star.svg';\r\n\r\nconst RestaurantDetailPage = () => {\r\n\r\n    let urlParams = useParams();\r\n    let [restaurant, setRestaurant] = useState([]);\r\n    let [visits, setVisits] = useState([]);\r\n    let [accountInfo, setAccountInfo] = useState([])\r\n\r\n    //Visit form data\r\n    let [visitDate, setVisitDate] = useState(null);\r\n    let [visitNote, setVisitNote] = useState('');\r\n    let [visitExpence, setVisitExpence] = useState(0);\r\n    let [visitEvaluation, setVisitEvaluation] = useState(1);\r\n\r\n    useEffect(() => {\r\n        axios.get(`http://127.0.0.1:8000/api/restaurants/${urlParams['restaurantName']}/`).then((response) => {\r\n            setRestaurant(response.data)\r\n        });\r\n\r\n        axios.get(`http://127.0.0.1:8000/api/visits/${urlParams['restaurantName']}/`).then((response) => {\r\n            setVisits(response.data);\r\n        });\r\n\r\n        axios.get('http://127.0.0.1:8000/auth/account').then((response) => {\r\n            setAccountInfo(response.data);\r\n        });\r\n    }, []);\r\n\r\n    const submitVisitForm = async e => {\r\n        e.preventDefault();\r\n\r\n        const visitFormData = {\r\n            date: visitDate,\r\n            note: visitNote,\r\n            expence: parseInt(visitExpence),\r\n            evaluation: parseInt(visitEvaluation),\r\n            restaurant: restaurant.id\r\n        }\r\n\r\n        await axios.post(`http://127.0.0.1:8000/api/visits/${urlParams['restaurantName']}/`, visitFormData, {headers: {'Content-Type': 'application/json'}, withCredentials: false}).then((response) => {\r\n            axios.get(`http://127.0.0.1:8000/api/visits/${urlParams['restaurantName']}/`).then((response) => {\r\n                setVisits(response.data);\r\n            })\r\n        })\r\n    }\r\n\r\n  return (\r\n    <div>\r\n        <div className='px-3'>\r\n            <h1 className='fw-bold'>{restaurant?.title}</h1>\r\n            <div className='d-flex flex-row'>\r\n                <div className='me-3'>\r\n                    <p className='m-0 p-0'>Total amount spent</p>\r\n                    <h3>$ {restaurant?.amount_spent?.expence__sum}</h3>\r\n                </div>\r\n\r\n                <div className='mx-3'>\r\n                    <p className='m-0 p-0'>Rating</p>\r\n                    <h3><Star /> {restaurant?.average_rating?.evaluation__avg}</h3>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        {accountInfo?.id === restaurant?.creator ?\r\n        <div className='w-100 d-flex flex-row justify-content-between align-items-end mt-5 px-3'>\r\n            <form className='d-flex flex-column' onSubmit={submitVisitForm}>\r\n                <h3 className='fw-bold'>Create Visit Form</h3>\r\n                <div className='d-flex flex-row'>\r\n                    <div className='my-2 mx-1'>\r\n                        <p className='m-0 p-0'>Date</p>\r\n                        <input type='date' className='form-control' onChange={(e) => setVisitDate(e.target.value)} />\r\n                    </div>\r\n\r\n                    <div className='my-2 mx-1'>\r\n                        <p className='m-0 p-0'>Money spent</p>\r\n                        <input type='number' className='form-control' onChange={(e) => setVisitExpence(e.target.value)} />\r\n                    </div>\r\n                </div>\r\n\r\n                <div className='d-flex flex-row '>\r\n                    <div className='me-2'>\r\n                        <p className='m-0 p-0'>Rating</p>\r\n                        <select className='form-control' onChange={(e) => setVisitEvaluation(e.target.value)}>\r\n                            <option value={1}>1</option>\r\n                            <option value={2}>2</option>\r\n                            <option value={3}>3</option>\r\n                            <option value={4}>4</option>\r\n                            <option value={5}>5</option>\r\n                        </select>\r\n                    </div>\r\n\r\n                    <div className='w-100'>\r\n                        <p className='m-0 p-0'>Note</p>\r\n                        <textarea className='w-100 form-control' onChange={(e) => setVisitNote(e.target.value)}></textarea>\r\n                    </div>\r\n                </div>\r\n\r\n                <button type='submit' className='btn btn-success my-2'>Create Visit</button>\r\n            </form>\r\n        </div> : null }\r\n        \r\n        <hr />\r\n        <div className='w-100 d-flex flex-column'>\r\n            {visits.map((visit, key) => (\r\n                <VisitItem key={key} visit={visit} />\r\n            ))}\r\n        </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default RestaurantDetailPage"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}